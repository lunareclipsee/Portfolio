--CREATE USER king identified by king account unlock;
--grant resource, dba, connect to king;

DROP TABLE MEMBER;
DROP TABLE STUDY;
DROP TABLE TUTOR_INFO;
DROP TABLE EVALUATION;
DROP TABLE QUESTION_BOARD;
DROP TABLE QUESTION_BOARD_COMMENT;
DROP TABLE FILE_PROFILE_IMAGE;
DROP TABLE MEMBER_GRADE;

DROP SEQUENCE MEMBER_MEMBER_NO_SEQ;
DROP SEQUENCE EVALUATION_IDX_SEQ;
DROP SEQUENCE QUESTION_BOARD_IDX_SEQ;
DROP SEQUENCE QUESTION_BOARD_COMMENT_IDX_SEQ;
DROP SEQUENCE FILE_PROFILE_IMAGE_IDX_SEQ;


select * from member order by MEMBER_NO;

CREATE TABLE MEMBER (
	MEMBER_NO	NUMBER	NOT NULL,
	MEMBER_EMAIL	VARCHAR2(50) UNIQUE	NOT NULL,
	MEMBER_PASSWORD	VARCHAR2(20)	NOT NULL,
	MEMBER_NAME	VARCHAR2(50)	NOT NULL,
	MEMBER_CREATE_DATE	DATE DEFAULT SYSDATE,
	MEMBER_MODIFY_DATE	DATE DEFAULT SYSDATE,
	MEMBER_COUNTRY	VARCHAR2(50)	NOT NULL,
	MEMBER_GENDER	VARCHAR2(1)	NOT NULL,
	MEMBER_BIRTH_DATE	DATE	NOT NULL,
	MEMBER_POINT	NUMBER	DEFAULT 0,
    MEMBER_GRADE	VARCHAR2(1)	NOT NULL
 
);

CREATE TABLE TUTOR_INFO (
	TUTOR_NO	NUMBER	NOT NULL,
	TUTOR_INTRODUCE	VARCHAR2(3000)	NOT NULL,
	YOUTUBE_URL	VARCHAR2(200)	NOT NULL,
	STUDY_NAME	VARCHAR2(120)	NOT NULL,
	PRICE	NUMBER	NOT NULL,
	STATUS_CHECK	VARCHAR2(1)	DEFAULT 'N'
);

CREATE TABLE EVALUATION (
	IDX	NUMBER	NOT NULL,
	TUTOR_NO	NUMBER	NOT NULL,
    STUDENT_NO	NUMBER	NULL,
	SCORE	NUMBER(1)	NULL,
	EVALUATE_CONTENT	VARCHAR2(300)	NULL,
	EVALUATE_CHECK	VARCHAR2(1)	NOT NULL,
	STUDENT_NAME	VARCHAR2(50)	NULL,
	EVALUATE_CREATE_DATE	DATE	NULL,
	STUDY_DATE	DATE	DEFAULT SYSDATE
);

CREATE TABLE QUESTION_BOARD (
	IDX	NUMBER	NOT NULL,
	MEMBER_NO	NUMBER	NOT NULL,
	TITLE	VARCHAR2(300)	,
	CONTENT	VARCHAR2(1500)	,
	BOARD_CREATE_DATE	DATE DEFAULT SYSDATE,
	BOARD_MODIFY_DATE	DATE DEFAULT SYSDATE,
	ANSWER_STATUS	VARCHAR2(1) DEFAULT 'N'
);

CREATE TABLE QUESTION_BOARD_COMMENT (
	IDX	NUMBER	NOT NULL,
	BOARD_NO	NUMBER	NOT NULL,
	COMMENT_CREATE_DATE	DATE		DEFAULT SYSDATE,
	REPLY	VARCHAR2(600)	NULL,
	ADMIN_NO	NUMBER	NOT NULL
);

CREATE TABLE FILE_PROFILE_IMAGE (
	IDX	NUMBER	NOT NULL,
	TUTOR_NO	NUMBER	NOT NULL,
	ORIGINAL_FILE_NAME	VARCHAR2(150)	NOT NULL,
	STORE_FILE_NAME	VARCHAR2(36)	NOT NULL,
	FILE_SIZE	NUMBER	NOT NULL,
	FILE_CREATE_DATE	DATE DEFAULT SYSDATE
);

CREATE TABLE MEMBER_GRADE (
	MEMBER_GRADE	VARCHAR2(1)	NOT NULL,
	GRADE_NAME	VARCHAR2(30)	NOT NULL
);

ALTER TABLE MEMBER ADD CONSTRAINT MEMBER_NO_PK PRIMARY KEY (
	MEMBER_NO
);

ALTER TABLE EVALUATION ADD CONSTRAINT EVALUATION_PK PRIMARY KEY (
	IDX
);

ALTER TABLE QUESTION_BOARD ADD CONSTRAINT QUESTION_BOARD_PK PRIMARY KEY (
	IDX
);

ALTER TABLE QUESTION_BOARD_COMMENT ADD CONSTRAINT QUESTION_BOARD_COMMENT_PK PRIMARY KEY (
	IDX
);

ALTER TABLE FILE_PROFILE_IMAGE ADD CONSTRAINT FILE_PROFILE_IMAGE_PK PRIMARY KEY (
	IDX
);

ALTER TABLE MEMBER_GRADE ADD CONSTRAINT MEMBER_GRADE_PK PRIMARY KEY (
	MEMBER_GRADE
);

ALTER TABLE MEMBER ADD CONSTRAINT MEMBER_GRADE_FK FOREIGN KEY (
	MEMBER_GRADE
) 
REFERENCES MEMBER_GRADE (
	MEMBER_GRADE
)on delete cascade;

ALTER TABLE TUTOR_INFO ADD CONSTRAINT TUTOR_INFO_NO_FK FOREIGN KEY (
	TUTOR_NO
)
REFERENCES MEMBER (
	MEMBER_NO
)on delete cascade;

ALTER TABLE EVALUATION ADD CONSTRAINT EVALUATION_NO_FK FOREIGN KEY (
	TUTOR_NO
)
REFERENCES MEMBER (
	MEMBER_NO
)on delete cascade;

ALTER TABLE QUESTION_BOARD ADD CONSTRAINT QUESTION_BOARD_NO_FK FOREIGN KEY (
	MEMBER_NO
)
REFERENCES MEMBER (
	MEMBER_NO
)on delete cascade;

ALTER TABLE QUESTION_BOARD_COMMENT ADD CONSTRAINT QUESTION_BOARD_COMMENT_IDX_FK FOREIGN KEY (
	BOARD_NO
)
REFERENCES QUESTION_BOARD (
	IDX
)on delete cascade;

ALTER TABLE FILE_PROFILE_IMAGE ADD CONSTRAINT FILE_PROFILE_IMAGE_NO_FK FOREIGN KEY (
	TUTOR_NO
)
REFERENCES MEMBER (
	MEMBER_NO
)on delete cascade;

CREATE SEQUENCE MEMBER_MEMBER_NO_SEQ
START WITH 69
INCREMENT BY 1;

CREATE SEQUENCE EVALUATION_IDX_SEQ
START WITH 265
INCREMENT BY 1;

CREATE SEQUENCE QUESTION_BOARD_IDX_SEQ
START WITH 10
INCREMENT BY 1;

CREATE SEQUENCE QUESTION_BOARD_COMMENT_IDX_SEQ
START WITH 6
INCREMENT BY 1;

CREATE SEQUENCE FILE_PROFILE_IMAGE_IDX_SEQ
START WITH 47
INCREMENT BY 1;